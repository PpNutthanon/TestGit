# Import Required Libraries
import numpy as np

#TODO: Create Interpolate Functions
def interpolate(x, x_points, y_points):
    for i in range(len(x_points)):
        if x_points[i] > x:
            if x_points[i - 1] == x:
                return y_points[i - 1]
            else:
                return y_points[i - 1] + (x - x_points[i - 1]) * ((y_points[i] - y_points[i - 1]) / (x_points[i] - x_points[i - 1]))
    return None

#! Table Data Saturated R22
#T = np.array([-30, -28, -26, -24, -22, -20, -18, -16, -14, -12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50])
#P = np.array([163.9, 178.2, 193.4, 209.7, 227, 245.3, 264.8, 285.4, 307.3, 330.4, 354.8, 380.5, 407.7, 436.3, 466.4, 498, 531.2, 566.1, 602.6, 640.9, 680.9, 722.9, 766.7, 812.4, 860.2, 910, 961.9, 1016, 1072, 1131, 1131, 1192, 1255, 1321, 1389, 1460, 1534, 1610, 1689, 1770, 1855, 1943])
#HF = np.array([165.82, 168.04, 170.27, 172.51, 174.75, 177.00, 179.26, 181.53, 183.81, 186.09, 188.38, 190.69, 193.00, 195.32, 197.66, 200.00, 202.35, 204.72, 207.10, 209.49, 211.89, 214.31, 216.74, 219.18, 221.63, 224.10, 226.59, 229.09, 231.60, 234.14, 236.69, 239.25, 241.84, 244.44, 247.06, 249.71, 252.37, 255.06, 257.77, 260.51, 263.27])
#SF = np.array([0.8685, 0.8776, 0.8866, 0.8955, 0.9044, 0.9133, 0.9222, 0.9309, 0.9397, 0.9484, 0.9571, 0.9657, 0.9743, 0.9829, 0.9915, 1.0000, 1.0085, 1.0170, 1.0254, 1.0338, 1.0422, 1.0506, 1.0590, 1.0673, 1.0756, 1.0840, 1.0923, 1.1006, 1.1088, 1.1171, 1.1254, 1.1336, 1.1419, 1.1501, 1.1584, 1.1667, 1.1749, 1.1832, 1.1915, 1.1998, 1.2081])
#SG = np.array([1.802, 1.798, 1.794, 1.790, 1.786, 1.783, 1.779, 1.776, 1.772, 1.769, 1.766, 1.763, 1.760, 1.757, 1.754,  1.751, 1.748, 1.745, 1.742, 1.739, 1.737, 1.734, 1.732, 1.729, 1.726, 1.724, 1.721, 1.719, 1.716, 1.714, 1.711, 1.709, 1.706, 1.704, 1.701, 1.698, 1.696, 1.693, 1.691, 1.688, 1.685])

T1 = [-100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95]
HG = [359.0, 359.5, 359.9, 360.4, 360.9, 361.4, 361.9, 362.4, 362.9, 363.4, 363.9, 364.3, 364.8, 365.3, 365.8, 366.3, 366.8, 367.3, 367.8, 368.3, 368.8, 369.3, 369.8, 370.3, 370.7, 371.2, 371.7, 372.2, 372.7, 373.2, 373.7, 374.2, 374.7, 375.2 ,375.7, 376.2, 376.6, 377.1, 377.6, 378.1, 378.6, 379.1, 379.6, 380.0, 380.5, 381.0, 381.5, 382.0, 382.5, 382.9, 383.4, 383.9, 384.4, 384.8,385.3, 385.8, 386.3, 386.7, 387.2, 387.7, 388.1, 388.6, 389.1, 389.5, 390.0, 390.4, 390.9, 391.3, 391.8, 392.2, 392.7, 393.1, 393.6, 394.0, 394.5, 394.9, 395.3, 395.8, 396.2, 396.6, 397.1, 397.5, 397.9, 398.3, 398.7, 399.2, 399.6, 400.0, 400.4, 400.8, 401.2, 401.6, 402.0, 402.4, 402.8, 403.2, 403.5, 403.9, 404.3, 404.7, 405.0, 405.4, 405.8, 406.1, 406.5, 406.8, 407.2, 407.5, 407.9, 408.2, 408.6, 408.9, 409.2, 409.5, 409.9, 410.2, 410.5, 410.8, 411.1, 411.4, 411.7, 411.9, 412.2, 412.5, 412.8, 413.0, 413.3, 413.5, 413.8, 414.0, 414.3, 414.5, 414.7, 414.9, 415.1, 415.3, 415.5, 415.7, 415.9, 416.1, 416.2, 416.4, 416.6, 416.7, 416.8, 417.0, 417.1, 417.2, 417.3, 417.4, 417.4, 417.5, 417.6, 417.6, 417.6, 417.7, 417.7, 417.7, 417.6, 417.6, 417.5, 417.5,417.4, 417.3, 417.2, 417.1, 416.9, 416.7, 416.5, 416.3, 416.1, 415.8, 415.5, 415.2, 414.9, 414.5, 414.1, 413.6, 413.1, 412.6, 412.0, 411.4, 410.7, 409.9, 409.1, 408.2, 407.2, 406.1, 404.8, 403.4, 401.9, 400.1, 397.9, 395.3, 392.0, 387.3]
SG = [2.054, 2.048, 2.042, 2.036, 2.031, 2.025, 2.019, 2.014, 2.009, 2.003, 1.998, 1.993, 1.988, 1.983, 1.978, 1.973, 1.969, 1.964, 1.960, 1.955, 1.951, 1.946, 1.942, 1.938, 1.934, 1.930, 1.926, 1.922, 1.918, 1.915, 1.911, 1.907, 1.904, 1.900, 1.897, 1.893, 1.890, 1.887, 1.883, 1.880, 1.877, 1.874, 1.871, 1.868, 1.865, 1.862, 1.859, 1.856, 1.853, 1.851, 1.848, 1.845, 1.843, 1.840, 1.838, 1.835, 1.833, 1.830, 1.828, 1.825, 1.823, 1.821, 1.819, 1.816, 1.814, 1.812, 1.810, 1.808, 1.806, 1.804, 1.802, 1.800, 1.798, 1.796, 1.794, 1.792, 1.790, 1.788, 1.786, 1.784, 1.783, 1.781, 1.779, 1.777, 1.776, 1.774, 1.772, 1.771, 1.769, 1.767, 1.766, 1.764, 1.763, 1.761, 1.760, 1.758, 1.757, 1.755, 1.754, 1.752, 1.751, 1.749, 1.748, 1.746, 1.745, 1.744, 1.742, 1.741, 1.739, 1.738, 1.737, 1.735, 1.734, 1.733, 1.732, 1.730, 1.729, 1.728, 1.726, 1.725, 1.724, 1.722, 1.721, 1.720, 1.719, 1.717, 1.716, 1.715, 1.714, 1.712, 1.711, 1.710, 1.709, 1.707, 1.706, 1.705, 1.704, 1.702, 1.701, 1.700, 1.698, 1.697, 1.696, 1.695, 1.693, 1.692, 1.691, 1.689, 1.688, 1.687, 1.685, 1.684, 1.682, 1.681, 1.680, 1.678, 1.677, 1.675, 1.674, 1.672, 1.670, 1.669, 1.667, 1.666, 1.664, 1.662, 1.660, 1.659, 1.657, 1.655, 1.653, 1.651, 1.649, 1.647, 1.645, 1.642, 1.640, 1.638, 1.635, 1.633, 1.630, 1.627, 1.624, 1.621, 1.618, 1.614, 1.610, 1.606, 1.602, 1.597, 1.592, 1.586, 1.580, 1.572, 1.562, 1.549]
P  = [2, 2.2, 2.4, 2.6, 2.9, 3.2, 3.4, 3.7, 4.1, 4.4, 4.8, 5.2, 5.7, 6.1, 6.6, 7.2, 7.7, 8.3, 9, 9.6, 10.4, 11.1, 12, 12.8, 13.8, 14.7, 15.8, 16.8, 18, 19.2, 20.5, 21.8, 23.2, 24.7, 26.3, 27.9, 29.7, 31.5, 33.4, 35.4, 37.5, 39.7, 42, 44.4, 46.9, 49.6, 52.3, 55.2, 58.2, 61.3, 64.5, 67.9, 71.5, 75.1, 78.9, 82.9, 87.1, 91.3, 95.8, 100.4, 105.2, 110.2, 115.4, 120.7, 126.3, 132.0, 138.0, 144.1, 150.5, 157.1, 163.9, 170.9, 178.2, 185.7, 193.4, 201.4, 209.7, 218.2, 227.0, 236.0, 245.3, 254.9, 264.8, 275.0, 285.4, 296.2, 307.3, 318.7, 330.4, 342.4, 354.8, 367.5, 380.5, 393.9, 407.7, 421.8, 436.3, 451.1, 466.4, 482.0, 498.0, 514.4, 531.2, 548.4, 566.1, 584.1, 602.6, 621.5, 640.9, 660.7, 680.9, 701.7, 722.9, 744.5, 766.7, 789.3, 812.4, 836.1, 860.2, 884.8, 910.0, 935.7, 961.9, 988.7, 1016.0, 1044.0, 1072.0, 1101.0, 1131.0, 1161.0, 1192.0, 1223.0, 1255.0, 1288.0, 1321.0, 1355.0, 1389.0, 1424.0, 1460.0, 1497.0, 1534.0, 1571.0, 1610.0, 1649.0, 1689.0, 1729.0, 1770.0, 1812.0, 1855.0, 1899.0, 1943.0, 1988.0, 2033.0, 2080.0, 2127.0, 2175.0, 2224.0, 2274.0, 2324.0, 2375.0, 2427.0, 2480.0, 2534.0, 2589.0, 2645.0, 2701.0, 2759.0, 2817.0, 2876.0, 2936.0, 2997.0, 3059.0, 3123.0, 3187.0, 3252.0, 3318.0, 3385.0, 3453.0, 3522.0, 3592.0, 3664.0, 3736.0, 3810.0, 3885.0, 3961.0, 4038.0, 4116.0, 4196.0, 4277.0, 4359.0, 4442.0, 4527.0, 4614.0, 4702.0, 4791.0, 4882.0, ]
HF = [90.7, 91.8, 92.8, 93.9, 95.0, 96.0, 97.1, 98.1, 99.2, 100.3, 101.3, 102.4, 103.4, 104.5, 105.6, 106.6, 107.7, 108.7, 109.8, 110.9, 111.9, 113.0, 114.1, 115.1, 116.2, 117.3, 118.3, 119.4, 120.4, 121.5, 122.6, 123.6, 124.7, 125.8, 126.8, 127.9, 129.0, 130.1, 131.1, 132.2, 133.3, 134.3, 135.4, 136.5, 137.6, 138.6, 139.7, 140.8, 141.9, 142.9, 144.0, 145.1, 146.2, 147.3, 148.4, 149.4, 150.5, 151.6, 152.7, 153.8, 154.9, 156.0, 157.1, 158.2, 159.3, 160.4, 161.5, 162.6, 163.7, 164.8, 165.9, 167.0, 168.1, 169.2, 170.3, 171.4, 172.6, 173.7, 174.8, 175.9, 177.0, 178.2, 179.3, 180.4, 181.6, 182.7, 183.8, 185.0, 186.1, 187.3, 188.4, 189.6, 190.7, 191.9, 193.0, 194.2, 195.3, 196.5, 197.7, 198.8, 200.0, 201.2, 202.4, 203.5, 204.7, 205.9, 207.1, 208.3, 209.5, 210.7, 211.9, 213.1, 214.3, 215.5, 216.7, 217.9, 219.1, 220.4, 221.6, 222.8, 224.1, 225.3, 226.5, 227.8, 229.0, 230.3, 231.5, 232.8, 234.1, 235.3, 236.6, 237.9, 239.2, 240.5, 241.8, 243.1, 244.4, 245.7, 247.0, 248.3, 249.6, 251.0, 252.3, 253.7, 255.0, 256.4, 257.7, 259.1, 260.5, 261.9, 263.2, 264.6, 266.0, 267.5, 268.9, 270.3, 271.8, 273.2, 274.7, 276.1, 277.6, 279.1, 280.6, 282.1, 283.6, 285.2, 286.7, 288.3, 289.9, 291.5, 293.1, 294.7, 296.4, 298.0, 299.7, 301.5, 303.2, 305.0, 306.8, 308.6, 310.4, 312.3, 314.3, 316.3, 318.3, 320.4, 322.5, 324.8, 327.1, 329.5, 332.1, 334.8, 337.8, 341.0, 344.8, 349.6]
print(len(T1),len(SG),len(HG),len(P),len(HF))
#TODO: Calculate H1 and S1 from P1
P1 = float(input("Enter Pressure I: "))
H1 = interpolate(P1, P, HG)
S1 = interpolate(P1, P, SG)
S2 = S1 
print("H1 values = ",round(H1,3))
print("S1 values = ",round(S1,3),"\n")

#TODO: Calculate H2, H3 and S3 from P3
P3 = float(input("Enter Pressure III: "))
H3 = interpolate(P3, P, HF)
#S3 = interpolate(P3, P, SG)
P2 = P3
H4 = H3 #* Throtting Valves
print("H3 values = ",round(H3,3))
#print("S3 values = ",round(S3,3),"\n")

#! Create Table Superheated R22
Hsup160 = [392.8, 396.0, 399.1, 402.3, 405.5, 408.8, 412.0, 415.3, 418.5, 421.8, 425.1, 428.5, 431.8, 435.2, 438.6, 442.0, 445.5]
Ssup160 = [1.804, 1.817, 1.830, 1.842, 1.855, 1.867, 1.879, 1.890, 1.902, 1.914, 1.925, 1.936, 1.947, 1.959, 1.970, 1.980, 1.991]
Hsup170 = [0, 395.7, 398.9, 402.1, 405.3, 408.6, 411.8, 415.1, 418.4, 421.7, 425.0, 428.3, 431.7, 435.1, 438.5, 441.9, 445.4]
Ssup170 = [0, 1.810, 1.823, 1.836, 1.848, 1.860, 1.872, 1.884, 1.896, 1.907, 1.919, 1.930, 1.941, 1.952, 1.963, 1.974, 1.985]
Tsup160 = [-30, -25, -20, -15, -10, -5, 0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50]
Tsup170 = Tsup160

#print(len(Hsup160),len(Ssup160),len(Ssup170),len(Hsup170),len(Tsup160))

#TODO: Calculate H2 From P2 and S2 Using Superheated R22 Table
if P2 == 160:
    H2 = interpolate(S2,Ssup160,Hsup160)
    print(round(H2,3))
elif 160<P2<170:
    H2Down = interpolate(S2,Ssup160,Hsup160)
    H2Up = interpolate(S2,Ssup170,Hsup170)
    H2 = H2Down + (((H2Up-H2Down)*(P2-160))/(170-160))
    print("H2 Values:",round(H2,3))

#TODO: Calculate Rated of Heat (QL) and Power Input to the Compressor (Win)
QL = (H1-H4)
print("QL Values:",round(QL,3))
Win = (H2-H1)
print("Win Values:",round(Win,3))
QH = (H2-H3)
print("QH Values:",round(QH,3))
COP = (QL/Win)
print("COP Values:",round(COP,3))







#TODO: ตอนแรกใช้ Interpolated HกับS โดยดูSเป็นหลัก
#TODO: คิด H ออกมาช่วงซ้ายกับช่วงขวา
#TODO: หา H โดยการ Interpolated HกับP

#ขั้นตอนแรกสุดให้ดูตาราง หา S => A13 ตามค่า Pressure ที่ได้ หา H => A12 ตามค่า Pressures